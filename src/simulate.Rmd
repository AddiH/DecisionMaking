```{r setup}
# install.packages("pacman")
pacman::p_load(tidyverse, R2jags, extraDistr)
source("../utils/PVL.R")
set.seed(69)
```

```{r}
# load payoff
payoff <- read.csv("../data/payoff.csv")
```

```{r}
w <- 2 # weighting parameter (aka. loss aversion)
A <- .5 # shape parameter (aka. risk aversion)
theta <- 3 # inverse heat parameter (aka. choice consitency)
a <- .1 # learning rate parameter (aka. prediction error weighting)
```


```{r}
PVL_sims <- PVL(payoff, ntrials, w, A, a, theta)
```


```{r}
par(mfrow = c(2, 2))
plot(PVL_sims$Ev[, 1], ylim = c(-1, 1))
plot(PVL_sims$Ev[, 2], ylim = c(-1, 1))
plot(PVL_sims$Ev[, 3], ylim = c(-1, 1))
plot(PVL_sims$Ev[, 4], ylim = c(-1, 1))
title(paste("Traces of expeceted value (Ev) for all four decks over", ntrials, "trials"), line = -1, outer = TRUE)

x <- PVL_sims$x
X <- PVL_sims$X
```

